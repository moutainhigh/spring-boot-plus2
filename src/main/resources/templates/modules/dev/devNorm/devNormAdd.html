<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>简易Markdown编辑器</title>
</head>

<!-- layui -->
<link rel="stylesheet" href="/components/layuiadmin/layui/css/layui.css">
<script src="/components/layuiadmin/layui/layui.js"></script>
<script src='/base/js/jquery-3.4.1.js'></script>
<script src="/base/js/app.js"></script>

<!--<style>-->
<!--    .easyeditor-fangge {-->
<!--        margin-top: 4%;-->
<!--    }-->
<!--</style>-->

<!-- layui样式 -->
<link rel="stylesheet" href="/components/easyeditor/layui/css/layui.css">
<!-- 部分自定义样式  -->
<link rel="stylesheet" href="/components/easyeditor/css/easyeditor.css">
<!-- 图标  -->
<link rel="stylesheet" type="text/css" href="//at.alicdn.com/t/font_1531710_xb357ub1wmg.css"/>
<body>

<!-- 置前 -->
<!--<div class="layui-form" lay-filter="layuiadmin-app-form-list" id="layuiadmin-app-form-list" style="position:fixed; z-index:999;display: block;  top:1%; left:1%; text-decoration: none;">-->
<div class="layui-form" lay-filter="layuiadmin-app-form-list" id="layuiadmin-app-form-list" style="padding: 20px 30px 0 0;">
    <div class="layui-form-item">
        <label class="layui-form-label">标题：</label>
        <div class="layui-input-inline" style="width: 60%">
            <input type="text" id="name" name="name" lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">排序</label>
        <div class="layui-input-inline">
            <input type="text" id="sort" name="sort" lay-verify="required" value="0" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item layui-hide">
        <input type="button" lay-submit lay-filter="layuiadmin-app-form-submit" id="layuiadmin-app-form-submit" value="确认添加">
        <input type="button" lay-submit lay-filter="layuiadmin-app-form-edit" id="layuiadmin-app-form-edit" value="确认编辑">
    </div>
</div>
<!-- Markdown编辑器元素 -->
<textarea id="L_content" name="content" style="" required lay-verify="required" placeholder="请输入发表内容" class="layui-textarea editor"></textarea>


<script src="/components/easyeditor/js/marked.min.js" type="text/javascript" charset="utf-8"></script>
<script src="/components/easyeditor/layui/layui.js"></script>
<script>
    layui.config({
        base: '/components/easyeditor/mods/' //存放layui拓展模块的目录位置
    }).extend({
        easyeditor: 'easyeditor'
    }).use(['easyeditor', 'form'], function () {
        var easyeditor = layui.easyeditor;
        //初始化Markdown编辑器
        easyeditor.init({
            elem: '.editor' //textarea 元素class
            , uploadUrl: '/upload' //图片上传地址
            , uploadSize: '' //限制的上传大小 单位kb 默认 1024k
            , style: 'fangge',//内置样式  目前只有默认 和 方格两种
            //codeStyle:'layuiCode', //代码风格 layuiCode风格 与 默认风格
            //,codeSkin:'notepad' //代码框样式 默认不填 与notepad 该属性与codeStyle='layuiCodexw'搭配使用
            //,buttonColor:'#FFB800' //自定义按钮颜色
            //,hoverBgColor:'red'  // 自定义鼠标悬浮背景颜色
            //,hoverColor:'#000000' // 自定义鼠标悬浮按钮颜色
        });
        //upload 接口要求返回的数据格式
        // 				{
        // 					code:0   ,//code=0代表文件保存成功 其他code值 则认为失败
        // 					msg:'图片保存失败' ,//搭配code使用 当code不等于 0 时,做出提示信息
        // 					url:'http://xxx.com/images/xxx.jpg' //图片上传成功后,图片的访问路径/保存路径,使用图片全路径
        // 				}

        // 监听提交
        layui.form.on('submit(layuiadmin-app-form-submit)', function (data) {
            data.field.content = $("#L_content").val();
            let result = ajaxPost(path + "/dev/devNorm/insert", data.field);
            let index = parent.layer.getFrameIndex(window.name);
            parent.layer.close(index);
            parent.layer.msg(result.msg);
            //重载表格
            parent.xijiaRenderTable(null);
        });
    });
</script>
</body>
</html>
